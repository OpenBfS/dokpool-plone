<tal:block i18n:domain="docpool.base"
           define="view nocall:options/view;
                   context nocall:options/context;
                   here nocall:context">
    <tal:def define="edoc options/edoc;
                 euid edoc/UID;
                 item_id edoc/id|edoc/getId;
                 item_title edoc/Title|edoc/title_or_id;
                 title_or_id python:item_title or item_id;                 
                 buttons options/buttons|nothing;
                 edocobj edoc/getObject;
                 elanobj view/elanobject;
                 isOverview options/isOverview;
                 isCollection options/isCollection;
                 individual context/isIndividual;
                 myfolder nocall:options/myfolder;
                 item_description edoc/Description;
                 eurl edoc/getURL;
                 item_url python:isCollection and '%s/@@dview?d=%s&disable_border=1' % (myfolder.absolute_url(), euid) or edoc.getURL(original=True);
                 item_url python:isOverview and eurl or item_url;
                 item_modified edoc/getMdate;
                 item_created edoc/CreationDate;
                 item_creator edoc/Creator;
                 toLocalizedTime nocall: context/@@plone/toLocalizedTime;
                 pas_member context/@@pas_member;
                 author python:pas_member.info(item_creator);
                 creator_fullname author/name_or_id;
                 tac elanobj/typeAndCat;
                 item_type python:tac[0];
                 item_cat python:tac[1];
                 item_cat python:', '.join(item_cat);
                 item_ptype edoc/portal_type;
                 normalizeString nocall: context/plone_utils/normalizeString;
                 item_type_class python:'contenttype-' + normalizeString(item_ptype);
                 rs edoc/review_state;
                 item_wf_state_class python:'state-' + normalizeString(rs);              
                 transferable python: not (individual or isOverview) and elanobj.transferable();
                 transferred context/transferred;
                 unknown_scen python:transferred and elanobj.unknownScenario() or None;
                 unknown_dt python:transferred and context.unknownDocType() or None;
                 unknown python: unknown_scen or unknown_dt;
                 navigation_root_url context/@@plone_portal_state/navigation_root_url;
                 ">
                <td class="actions" tal:condition="python:not isOverview and not isCollection">
                    <div metal:use-macro="here/@@dp.macros/macros/cb"/> 
                    <div metal:use-macro="here/@@dp.macros/macros/delete"/> 
                    <div metal:use-macro="here/@@elan.macros/macros/docactions"/> 
                </td>
                <td class="title">
                    <div metal:use-macro="here/@@dp.macros/macros/doccontent"/> 
			        <div class="map">
                    <tal:insert replace="structure python:context.getMapImage(scale='/@@images/image/thumb')" />
			        </div>
			        <div class="pdflink" tal:define="pdf context/getRepresentativePDF" tal:condition="nocall:pdf">
			            <a href="${pdf/absolute_url}" target="_blank" i18n:domain="docpool.config" i18n:translate="">Printable version</a>
			        </div>
                </td>
                <td class="metadata">
                    <div metal:use-macro="here/@@elan.macros/macros/docmetadata"/> 
                </td>
    </tal:def> 
</tal:block>